---
title: "Homework 2"
subtitle: "Summary Report for the Mushroom Dataset"
date: today
author: Tsai, Bing-Yan
format:
 pdf:
    include-in-header:
      - text: |
         \usepackage{setspace,relsize}
         \usepackage{geometry}
         \geometry{verbose,tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2.5cm}
#mainfont: "Microsoft JhengHei UI"
#mainfont: "Microsoft JhengHei"
mainfont: "Microsoft JhengHei Bold"
toc: true
lang: zh-Tw
documentclass: article
pdf-engine: xelatex
execute:
  tidy: true
  echo: true
  warning: false
  message: false
---

## 1.Variable Definition

![Variable Definition](%22D:\Desktop\2025Spring\2025Spring_Statistical_Consulting\Homework2\hw2_variable_definition.jpg%22)

## 2.Data Description

```{r}
#| results: asis
library(reticulate)
library(Hmisc)

data <- read.csv("D:\\Desktop\\2025Spring\\2025Spring_Statistical_Consulting\\Homework2\\mushroom\\primary_data.csv", sep = ';')
latex(describe(data), file="", options=list(tabenv="longtable"))
```

## 3.Table 1

```{r}
library(dplyr)
library(tidyr)
library(stringr)
library(table1)

numerical_cols <- c("cap.diameter", "stem.height", "stem.width")
categorical_cols <- setdiff(colnames(data), c("family", "name", "class", numerical_cols))

expand_categorical_features <- function(df, categorical_cols) {
  df_expanded <- df
  
  for (col in categorical_cols) {
    df_expanded <- df_expanded %>%
      mutate(!!sym(col) := str_split(!!sym(col), ",\\s*")) %>%  # Split and trim spaces
      unnest(!!sym(col)) %>%
      mutate(!!sym(col) := str_replace_all(!!sym(col), "[\\[\\]]", ""))  # Remove brackets
  }
  
  return(df_expanded)
}

expanded_list <- expand_categorical_features(data, categorical_cols)

formula <- as.formula(paste("~", paste(c(categorical_cols, numerical_cols), collapse = " + "), " | class"))

table1(formula, data = expanded_list)

# With the help from Chat-GPT

```
